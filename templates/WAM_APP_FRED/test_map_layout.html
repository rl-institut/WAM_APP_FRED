<!DOCTYPE html>
{% load leaflet_tags %}
{% load static %}


<html class="no-js" lang="en">
  <head>


    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>open_eGo VIS</title>
    <link rel="stylesheet" type="text/css" href="{% static 'stemp_abw/img/ionicons-2.0.1/css/ionicons.css' %}">
    <link rel="stylesheet" href="{% static 'WAM_APP_eGo_VIS/css/app.css' %}">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>
    {% leaflet_js %}
    {% leaflet_css %}
  </head>
  <body>

    <div class="l-bg-color-w u-vh--100">
    
        <!-- TOP NAVIGATION START -->
        <!-- MAIN NAVIGATION START -->
            
        <nav>
          <div class="title-bar" id="nav-container" data-responsive-toggle="simple-menu" data-hide-for="medium">
            <button class="menu-icon" type="button" data-toggle></button>
            <div class="title-bar-title"></div>
          </div>
          
          <div class="top-bar" id="simple-menu">
            <div class="top-bar-left show-for-large">
              <ul class="menu">

              </ul>
            </div>
            <div class="top-bar-right">
              <ul class="dropdown menu" id="nav-list-vertical" data-dropdown-menu>
                <li>
                  <a class="anchor-text--light" href="#">Menu</a>
                  <ul class="menu vertical">

                    <li><a class="anchor-text--light" href="#">Kontakt</a></li>
                    <li><a class="anchor-text--light" href="#">Impressum</a></li>
                    <li><a class="anchor-text--light" href="#">Datenschutz</a></li>
                    <li><a class="anchor-text--light" href="#">Quellen</a></li>
                  </ul>
                </li>
              </ul>
            </div>
          </div>
        </nav>
            
        <!-- MAIN NAVIGATION END -->    <!-- TOP NAVIGATION END -->
        
        <div class="off-canvas-wrapper off-canvas-wrapper--left">
      
          <!-- OFF CANVAS START -->
          <div class="off-canvas position-left" id="offCanvas" data-off-canvas data-close-on-click="false" data-content-overlay="false" data-transition="overlap" style="color: black; overflow-y: hidden">
            
            <div class="grid-y medium-grid-frame">
              <div class="cell medium-auto medium-cell-block-container">
                <div class="grid-x">
                  <div class="cell small-3 offcanvas-tabs__wrapper medium-cell-block-y">
                    <ul class="vertical tabs" data-tabs id="offcanvas-tabs">
                      <li class="tabs-title is-active">
                        <a href="#panel-scenario" aria-selected="true">
                          <img src="{% static 'stemp_abw/img/icons_custom/Windrad.svg' %}">
                          <h2>Szenario</h2>
                        </a>
                      </li>
                      <li class="tabs-title">
                        <a href="#panel-energy-system">
                          <img src="{% static 'stemp_abw/img/icons_custom/Windrad.svg' %}">
                          <h2>Energiesystem</h2>
                        </a>
                      </li>
                      <li class="tabs-title">
                        <a href="#panel3v">
                          <img src="{% static 'stemp_abw/img/icons_custom/Windrad.svg' %}">
                          <h2>Flächen</h2>
                        </a>
                      </li>
                      <li class="tabs-title">
                        <a href="#panel4v">
                          <img src="{% static 'stemp_abw/img/icons_custom/Windrad.svg' %}">
                          <h2>Ergebnisse</h2>
                        </a>
                      </li>
                    </ul>
            
                  </div>
                  <div class="cell small-9 medium-cell-block-y tabs-content__wrapper">
                      <div class="tabs-content" data-tabs-content="offcanvas-tabs">
    
                        <!-- First panel content -->
                        <div class="tabs-panel is-active" id="panel-scenario">
                          <form>
                            <fieldset>
                              <legend>Szenario auswählen 
                                <i class ="icon ion-information-circled icon--small" title="Informationen zum Inhalt"></i>
                              </legend>
                              <div>
                                <input type="radio" name="scenario" value="statusQuo" id="scenarioStatusQuo" required checked>
                                <label for="scenarioStatusQuo">Status Quo</label>
                              </div>
                              <div>
                                <input type="radio" name="scenario" value="germany" id="scenarioGermany">
                                <label for="scenarioGermany">Deutsches Klimaschutzziel</label>
                              </div>
                              <div>
                                <input type="radio" name="scenario" value="100" id="scenario100">
                                <label for="scenario100">100% EE in der Region</label>
                              </div>
                            </fieldset>
                          </form>
                          <div class="panel__text panel__text--highlighted">
                            <p id="scenarioPanelText">
                                <span style="font-weight:700">Status Quo</span><span style="display:inline-block">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</span>
                            </p>
                          </div>
                        </div>
          
                        <!-- Second panel content -->
                        <div class="tabs-panel" id="panel-energy-system">
                          <ul class="accordion" data-accordion>
                            <li class="accordion-item accordion-item--no-border is-active" data-accordion-item>
                              <a href="#" class="accordion-title accordion-title--100">Stromerzeugung</a>
                              <div class="accordion-content" data-tab-content >
                                <p>Panel 1. Lorem ipsum dolor</p>
                              </div>
                            </li>
                            <li class="accordion-item" data-accordion-item>
                              <a href="#" class="accordion-title accordion-title--100">Wärmeerzeugung</a>
                              <div class="accordion-content" data-tab-content>
                                <textarea></textarea>
                                <button class="button">I do nothing!</button>
                              </div>
                            </li>
                            <li class="accordion-item" data-accordion-item>
                              <a href="#" class="accordion-title accordion-title--100">Strombedarf</a>
                              <div class="accordion-content" data-tab-content>
                                Type your name!
                                <input type="text"></input>
                              </div>
                            </li>
                          </ul>
                        </div>
          
                        <!-- Third panel content -->
                        <div class="tabs-panel" id="panel3v">
                          <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
                          <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
                          <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
                          <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
                          <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
                          <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
                          <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
                          <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
                          <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
                          <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
                          <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
                        </div>
          
                        <!-- Fourth panel content -->
                        <div class="tabs-panel" id="panel4v">
                          <p>Four</p>
                          <img class="thumbnail" src="{% static 'stemp_abw/img/generic/rectangle-2.jpg' %}">
                        </div>
                      </div>
    
                  </div>
                </div>
              </div>
            </div>
    
            <button class="close-button" aria-label="Close menu" type="button" data-close>
              <span aria-hidden="true">&times;</span>
            </button>
    
          </div>
          <!-- OFF CANVAS END -->
      
          <!-- CONTENT (MAP + FOOTER) START -->
          <main class="off-canvas-content" data-off-canvas-content>
            <div class="map-wrapper">
              
              <button type="button" class="button open-offcanvas" data-toggle="offCanvas" title="Parameter">
                <i class="icon ion-android-options"></i>
              </button>

              {% leaflet_map "map" callback="window.map_init_basic" %}
      
            </div>
          </main>
          <!-- CONTENT (MAP + FOOTER) END -->
      
        </div>
      
        <footer class="map-footer">
          <div class="grid-x">
    
            <div class="cell medium-4 large-6">
              <ul class="map-footer__legal">
                <li>
                  <a class="anchor-text--dark" href="#">Impressum</a>
                </li>
                <li>
                  <a class="anchor-text--dark" href="#">Datenschutz</a>
                </li>
              </ul>
            </div>
    
            <div class="cell medium-8 large-6">
              <ul class="map-footer__logo">
                <li>
                  <a href="https://www.energieavantgarde.de/" target="_blank" title="Energieavantgarde Anhalt">
                    <img class="map-footer__logo-eaa" src="{% static 'stemp_abw/img/EAA_logo.png' %}" alt="Logo Energieavantgarde Anhalt">
                  </a>
                </li>
                <li>
                  <a href="https://reiner-lemoine-institut.de/" target="_blank" title="Reiner Lemoine Institut">
                    <img class="map-footer__logo-rli" src="{% static 'stemp_abw/img/rli_logo.png' %}" alt="Logo Reiner Lemoine Institut">
                  </a>
                </li>
                <li>
                  <a href="https://www.kopernikus-projekte.de/" target="_blank" title="Kopernikus Projekte">
                    <img class="map-footer__logo-kopernikus" src="{% static 'stemp_abw/img/kopernikus_logo.png' %}" alt="Logo Kopernikus">
                  </a>
                </li>
                <li>
                  <a href="https://www.bmbf.de/" target="_blank" title="Bundesministerium für Bildung und Forschung">
                    <img class="map-footer__logo-bmbf" src="{% static 'stemp_abw/img/BMBF_widget_final.png' %}" alt="Logo BMBF">
                  </a>
                </li>
              </ul>
            </div>
    
          </div>
        </footer>
      
      </div>

    <script src="{% static 'WAM_APP_eGo_VIS/js/app.js' %}"></script>

       <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script type="text/javascript">

            var lines_dataurl = "{% url 'app_eGoVIS:Lines'|add:'.data' %}" // done
            var lvbranchtee_dataurl = "{% url 'app_eGoVIS:LvBranchtee'|add:'.data' %}" // empty
            var lvgenerator_dataurl = "{% url 'app_eGoVIS:LvGenerator'|add:'.data' %}" // done
            var lvgrid_dataurl = "{% url 'app_eGoVIS:LvGrid'|add:'.data' %}" // done
            var lvloadarea_dataurl = "{% url 'app_eGoVIS:LvLoadarea'|add:'.data' %}" // empty
            var lvstation_dataurl = "{% url 'app_eGoVIS:LvStation'|add:'.data' %}" // no symbology yet
            var mvbranchtee_dataurl = "{% url 'app_eGoVIS:MvBranchtee'|add:'.data' %}" // done
            var mvcircuitbreaker_dataurl = "{% url 'app_eGoVIS:MvCircuitbreaker'|add:'.data' %}"
            var mvgenerator_dataurl = "{% url 'app_eGoVIS:MvGenerator'|add:'.data' %}" // done
            var mvgrid_dataurl = "{% url 'app_eGoVIS:MvGrid'|add:'.data' %}" // done
            var mvload_dataurl = "{% url 'app_eGoVIS:MvLoad'|add:'.data' %}" // empty
            var mvstation_dataurl = "{% url 'app_eGoVIS:MvStation'|add:'.data' %}" // empty
            var hvmvtransformer_dataurl = "{% url 'app_eGoVIS:HvmvTransformer'|add:'.data' %}" // done
            var mvlvtransformer_dataurl = "{% url 'app_eGoVIS:MvlvTransformer'|add:'.data' %}" // empty

            var mvgenerator_layer = L.geoJSON([], {
                style: function (feature) {
                    return feature.properties && feature.properties.style;
                },
                    pointToLayer: function (feature, latlng) {
                        return L.circleMarker(latlng, {
                            radius: 4,
                            fillColor: "#81c3d7",
                            color: "black",
                            weight: 1,
                            opacity: 1,
                            fillOpacity: 1,
                            interactive: false,
                        });
                    }
            })

            var biomassIcon = L.icon({
                iconUrl: "{% static 'WAM_APP_eGo_VIS/Icons/Pin_biomass_color_v2.svg' %}",
                iconSize:     [38, 95], // size of the icon
                iconAnchor:   [19, 72], // point of the icon which will correspond to marker's location
                popupAnchor:  [0, -20] // point from which the popup should open relative to the iconAnchor
            });

            var circuitbreakerMvIcon = L.icon({
                iconUrl: "{% static 'WAM_APP_eGo_VIS/Icons/Circuit_breaker_MEDIUM.svg' %}",
                iconSize:     [36, 44], // size of the icon
                iconAnchor:   [18, 44], // point of the icon which will correspond to marker's location
                popupAnchor:  [0, -20] // point from which the popup should open relative to the iconAnchor
            });

            var hydroIcon = L.icon({
                iconUrl: "{% static 'WAM_APP_eGo_VIS/Icons/Pin_hydropower_color_v2.svg' %}",
                iconSize:     [36, 44], // size of the icon
                iconAnchor:   [18, 44], // point of the icon which will correspond to marker's location
                popupAnchor:  [0, -20] // point from which the popup should open relative to the iconAnchor
            });

            var solarGroundIcon = L.icon({
                iconUrl: "{% static 'WAM_APP_eGo_VIS/Icons/Pin_solarenergy_ground_color_v2.svg' %}",
                iconSize:     [36, 44], // size of the icon
                iconAnchor:   [18, 44], // point of the icon which will correspond to marker's location
                popupAnchor:  [0, -20] // point from which the popup should open relative to the iconAnchor
            });

            var solarRoofIcon = L.icon({
                iconUrl: "{% static 'WAM_APP_eGo_VIS/Icons/Pin_solarenergy_roof_color_v2.svg' %}",
                iconSize:     [36, 44], // size of the icon
                iconAnchor:   [18, 38], // point of the icon which will correspond to marker's location
                popupAnchor:  [0, -20] // point from which the popup should open relative to the iconAnchor
            });

            var tLvIcon = L.icon({
                iconUrl: "{% static 'WAM_APP_eGo_VIS/Icons/T_thick_LOW_v2.svg' %}",
                iconSize:     [36, 44], // size of the icon
                iconAnchor:   [18, 20], // point of the icon which will correspond to marker's location
                popupAnchor:  [0, 0] // point from which the popup should open relative to the iconAnchor
            });

            var tMvIcon = L.icon({
                iconUrl: "{% static 'WAM_APP_eGo_VIS/Icons/T_thick_MEDIUM_v2.svg' %}",
                iconSize:     [36, 44], // size of the icon
                iconAnchor:   [18, 20], // point of the icon which will correspond to marker's location
                popupAnchor:  [0, 0] // point from which the popup should open relative to the iconAnchor
            });

            var transformerHvMvIcon = L.icon({
                iconUrl: "{% static 'WAM_APP_eGo_VIS/Icons/Transfomer_thick_HIGH_MEDIUM.svg' %}",
                iconSize:     [54, 66], // size of the icon
                iconAnchor:   [36, 30], // point of the icon which will correspond to marker's location
                popupAnchor:  [0, 0] // point from which the popup should open relative to the iconAnchor
            });

            var transformerMvLvIcon = L.icon({
                iconUrl: "{% static 'WAM_APP_eGo_VIS/Icons/Transfomer_thick_MEDIUM_LOW.svg' %}",
                iconSize:     [36, 44], // size of the icon
                iconAnchor:   [18, 20], // point of the icon which will correspond to marker's location
                popupAnchor:  [0, 0] // point from which the popup should open relative to the iconAnchor
            });

            var windOffIcon = L.icon({
                iconUrl: "{% static 'WAM_APP_eGo_VIS/Icons/Pin_windenergy_offshore_color_v2.svg' %}",
                iconSize:     [36, 44], // size of the icon
                iconAnchor:   [18, 44], // point of the icon which will correspond to marker's location
                popupAnchor:  [0, -20] // point from which the popup should open relative to the iconAnchor
            });

            var windOnIcon = L.icon({
                iconUrl: "{% static 'WAM_APP_eGo_VIS/Icons/Pin_windenergy_onshore_color_v2.svg' %}",
                iconSize:     [36, 44], // size of the icon
                iconAnchor:   [18, 44], // point of the icon which will correspond to marker's location
                popupAnchor:  [0, -20] // point from which the popup should open relative to the iconAnchor
            });




        </script>

        <script type="text/javascript">


            function map_init_basic (map, options) {
                var popup = L.popup()

                L.marker([53.4554, 9.6211], {icon: biomassIcon}).addTo(map); // example marker to quickly show if map loads

/*                var dataurl_array = //[lvbranchtee_dataurl, lvloadarea_dataurl, //mvgrid_dataurl, lines_dataurl
                                    //lvstation_dataurl, mvbranchtee_dataurl, mvcircuitbreaker_dataurl,
                                    //mvload_dataurl, mvstation_dataurl, hvmvtransformer_dataurl,
                                    //mvlvtransformer_dataurl];

                var arr_length = dataurl_array.length;
                var i;

                for (i = 0; i < arr_length; i++) {

                // Load GeoJsons via Ajax and add layers to map
                $.ajax({

                    url: dataurl_array[i],
                    dataType: 'json',
                    async: true,
                    success: function(geofeature){

                        function onEachFeature(geofeature, layer) {
                            // does this feature have a property named popupContent?
                            if (geofeature.properties) {
                                layer.bindPopup(geofeature.properties.name);
                            }
                        }
                        var layer = new L.geoJSON(geofeature, {
                            onEachFeature: onEachFeature,
                            pointToLayer: function (feature, latlng) {
                                if (feature.subtype == "solar_roof_mounted") {
                                    return L.marker(latlng, {icon: transformerHvMvIcon});
                                }
                            }

                        })
                        map.addLayer(layer)

                        }
                });

                }
*/

                // LV Generators
                $.ajax({
                    url: lvgenerator_dataurl,
                    dataType: 'json',
                    async: true,
                    success: function(lvgenerator){
                        function onEachFeature(lvgenerator, layer) {
                            enablePopup(lvgenerator, layer);
                        }
                        var layer = new L.geoJSON(lvgenerator, {
                            onEachFeature: onEachFeature,
                            pointToLayer: function (feature, latlng) {
                                if (feature.properties.subtype == "solar_roof_mounted") {
                                    return L.marker(latlng, {icon: solarRoofIcon});
                                }
                                if (feature.properties.subtype == "solar_ground_mounted") {
                                    return L.marker(latlng, {icon: solarGroundIcon});
                                }
                                if (feature.properties.subtype == "biomass") {
                                    return L.marker(latlng, {icon: biomassIcon});
                                }
                                if (feature.properties.subtype == "wind_onshore") {
                                    return L.marker(latlng, {icon: windOnIcon});
                                }
                                if (feature.properties.subtype == "wind_offshore") {
                                    return L.marker(latlng, {icon: windOffIcon});
                                }
                            }
                        })
                        map.addLayer(layer)
                        }
                });


                // MV Generators
                $.ajax({
                    url: mvgenerator_dataurl,
                    dataType: 'json',
                    async: true,
                    success: function(mvgenerator){
                        function onEachFeature(mvgenerator, layer) {
                            enablePopup(mvgenerator, layer);
                        }
                        var layer = new L.geoJSON(mvgenerator, {
                            onEachFeature: onEachFeature,
                            pointToLayer: function (feature, latlng) {
                                if (feature.properties.subtype == "solar_roof_mounted") {
                                    return L.marker(latlng, {icon: solarRoofIcon});
                                }
                                if (feature.properties.subtype == "solar_ground_mounted") {
                                    return L.marker(latlng, {icon: solarGroundIcon});
                                }
                                if (feature.properties.subtype == "biomass") {
                                    return L.marker(latlng, {icon: biomassIcon});
                                }
                                if (feature.properties.subtype == "wind_onshore") {
                                    return L.marker(latlng, {icon: windOnIcon});
                                }
                                if (feature.properties.subtype == "wind_offshore") {
                                    return L.marker(latlng, {icon: windOffIcon});
                                }
                            }
                        })
                        map.addLayer(layer)
                        }
                });

                var lvGridStyle = {
                    opacity: 0.7,
                    weight: 1,
                    fillOpacity: 0.7,
                    color: "#da9700",
                    fillColor: "#da9700",
                };

                var mvGridStyle = {
                    opacity: 0.7,
                    weight: 3,
                    fillOpacity: 0.0,
                    color: "#b45801",
                    fillColor: "#b45801",
                };

                var loadAreaStyle = {
                    opacity: 0.7,
                    weight: 1,
                    fillOpacity: 0.7,
                    color: "#8094af",
                    fillColor: "#8094af",
                };

                var powerLinesStyle = {
                    opacity: 0.7,
                    weight: 4,
                    color: "#000000",
                };

                var highlightStyle = {
                    opacity: 0.7,
                    weight: 2,
                    fillOpacity: 0.7,
                    color: "#0000ff",
                    fillColor: "#0ba0ff",
                };

                var clickedStyle = {
                    opacity: 0.7,
                    weight: 2,
                    fillOpacity: 0.7,
                    color: "#00ff00",
                    fillColor: "#00ffff",
                };

            function enablePopup(geojson, layer){
                if (geojson.properties) {
                    var keys = Object.keys(geojson.properties);
                    var content = '<table class="selection_detail">';
                    for (let i = 0, len = keys.length; i < len; i++){
                        if (keys[i] !== "model"){
                            content = content + '<tr><td align="right"><b>' + keys[i] + '</b>:</td><td>' + geojson.properties[keys[i]] + '</td></tr>'
                        }
                    }
                    content = content + '</table>';
                    layer.bindPopup(content);
                }
            }


                // LV Grid
                $.ajax({
                    url: lvgrid_dataurl,
                    dataType: 'json',
                    async: true,
                    success: function(lv){
                        function onEachFeature(lv, layer) {
                            layer.on('mouseover', function () {
                              this.setStyle(highlightStyle);
                            });
                            layer.on('click', function () {
                              this.setStyle(highlightStyle);
                            });
                            layer.on('mouseout', function () {
                              this.setStyle(lvGridStyle);
                            });
                            enablePopup(lv, layer);
                        }
                        var layer = new L.geoJSON(lv, {
                            onEachFeature: onEachFeature,
                            style: function (feature, latlng) {
                                return lvGridStyle;
                            }
                        })
                        map.addLayer(layer)
                        }
                });

                // MV Grid
                $.ajax({
                    url: mvgrid_dataurl,
                    dataType: 'json',
                    async: true,
                    success: function(mv){
                        function onEachFeature(mv, layer) {
                            enablePopup(mv, layer);
                        }
                        var layer = new L.geoJSON(mv, {
                            onEachFeature: onEachFeature,
                            style: function (feature, latlng) {
                                return mvGridStyle;
                            }
                        })
                        map.addLayer(layer);
                        layer.bringToBack();
                        }
                });

                // mv Load point geometry no icon
                /*$.ajax({
                    url: mvload_dataurl,
                    dataType: 'json',
                    async: true,
                    success: function(mvload){
                        function onEachFeature(mvload, layer) {
                            enablePopup(mvload, layer);
                        }
                        var layer = new L.geoJSON(mvload, {
                            onEachFeature: onEachFeature,
                            style: function (feature, latlng) {
                                return loadAreaStyle;
                            }
                        })
                        map.addLayer(layer)
                        }
                });*/

                // lv Station
                $.ajax({
                    url: lvstation_dataurl,
                    dataType: 'json',
                    async: true,
                    success: function(lvstation){
                        function onEachFeature(lvstation, layer) {
                            enablePopup(lvstation, layer);
                        }
                        var layer = new L.geoJSON(lvstation, {
                            onEachFeature: onEachFeature,
                            pointToLayer: function (feature, latlng) {
                                return L.marker(latlng, {icon: transformerMvLvIcon}, nohide = true);
                            }
                        })
                        map.addLayer(layer)
                        layer.toFront();
                        }
                });

                // HV-MV Transformer
                $.ajax({
                    url: hvmvtransformer_dataurl,
                    dataType: 'json',
                    async: true,
                    success: function(hvmvt){
                        function onEachFeature(hvmvt, layer) {
                            enablePopup(hvmvt, layer);
                        }
                        var layer = new L.geoJSON(hvmvt, {
                            onEachFeature: onEachFeature,
                            pointToLayer: function (feature, latlng) {
                                return L.marker(latlng, {icon: transformerHvMvIcon}, nohide = true);
                            }
                        })
                        map.addLayer(layer)
                        layer.toFront();
                        }
                });

                // LV BranchTee
                $.ajax({
                    url: mvbranchtee_dataurl,
                    dataType: 'json',
                    async: true,
                    success: function(mvbt){
                        function onEachFeature(mvbt, layer) {
                            enablePopup(mvbt, layer);
                        }
                        var layer = new L.geoJSON(mvbt, {
                            onEachFeature: onEachFeature,
                            pointToLayer: function (feature, latlng) {
                                return L.marker(latlng, {icon: tMvIcon});
                            }
                        })
                        map.addLayer(layer)
                        layer.bringToBack();
                        }
                });



                // Lines
                $.ajax({
                    url: lines_dataurl,
                    dataType: 'json',
                    async: true,
                    success: function(plines){
                        function onEachFeature(plines, layer) {
                            enablePopup(plines, layer);
                        }
                        var layer = new L.geoJSON(plines, {
                            onEachFeature: onEachFeature,
                            style: function (feature, latlng) {
                                return powerLinesStyle;
                            }
                        })
                        map.addLayer(layer);
                        layer.bringToFront();
                        }
                });

        }

        </script>
  </body>
</html>